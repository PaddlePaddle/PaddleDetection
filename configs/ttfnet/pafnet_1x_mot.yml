_BASE_: [
  '../datasets/coco_detection.yml',
  '../runtime.yml',
  '_base_/optimizer_10x.yml',
  '_base_/pafnet.yml',
  '_base_/pafnet_reader.yml',
]
weights: https://paddledet.bj.bcebos.com/models/pafnet_10x_coco.pdparams
pretrain_weights: https://paddledet.bj.bcebos.com/models/pafnet_10x_coco.pdparams
epoch: 12
metric: MOTDet

LearningRate:
  base_lr: 0.0025
  schedulers:
  - !PiecewiseDecay
    gamma: 0.1
    milestones: [8, 11]
  - !LinearWarmup
    start_factor: 0.2
    steps: 500

OptimizerBuilder:
  optimizer:
    momentum: 0.9
    type: Momentum
  regularizer:
    factor: 0.0004
    type: L2

TrainReader:
  sample_transforms:
    - Decode: {}
    - RGBReverse: {}
    - AugmentHSV: {}
    - LetterBoxResize: {target_size: [608, 1088]}
    - MOTRandomAffine: {reject_outside: False}
    - RandomFlip: {}
    - BboxXYXY2XYWH: {}
    - NormalizeBox: {}
    - NormalizeImage: {mean: [123.675, 116.28, 103.53], std: [58.395, 57.12, 57.375], is_scale: false}
    - RGBReverse: {}
    - Permute: {}
  batch_transforms:
    - Gt2PPMOTTarget: {}
  batch_size: 6
  shuffle: true
  drop_last: true
  use_shared_memory: true

EvalReader:
  sample_transforms:
    - Decode: {}
    - LetterBoxResize: {target_size: [608, 1088]}
    - NormalizeImage: {mean: [123.675, 116.28, 103.53], std: [58.395, 57.12, 57.375], is_scale: false}
    - Permute: {}
  batch_size: 1
  drop_last: false

# for MOT training
TrainDataset:
  !MOTDataSet
    dataset_dir: /root/data/mot
    image_lists: ['mot17.train', 'caltech.all', 'cuhksysu.train', 'prw.train', 'citypersons.train', 'eth.train']
    data_fields: ['image', 'gt_bbox', 'gt_class', 'gt_ide']

EvalDataset:
  !MOTDataSet
    dataset_dir: /root/data/mot #dataset/mot
    image_lists: ['citypersons.val', 'caltech.val'] # for detection evaluation
    # image_lists: ['caltech.10k.val', 'cuhksysu.val', 'prw.val'] # for reid evaluation
    data_fields: ['image', 'gt_bbox', 'gt_class', 'gt_ide']
